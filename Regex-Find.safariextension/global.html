<script>

safari.application.addEventListener("command", performCommand, false);

function performCommand(event) {
    if (event.command == "regex-find") {
        safari.application.activeBrowserWindow.activeTab.page.dispatchMessage("search", null);
    }
}

// Listens to message from injected keyboardShortcutHandler.js
safari.application.addEventListener('message', handleKeyboardMessage, false);

// Message gets caught, reopenClosedTabs() gets called
function handleKeyboardMessage(e) {
    if (e.name == 'regex-find') {
        safari.application.activeBrowserWindow.activeTab.page.dispatchMessage("search", null);
    }

}

</script>
